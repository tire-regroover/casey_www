<!DOCTYPE html>
<html>
<head>
<title>Casey</title>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
  box-sizing: border-box;
}
body {
  font-family: system-ui,-apple-system,system-ui,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",sans-serif;
  background-color: #fff;
  color: #888;
}
button {
  margin: 5px 0;
  font-weight: 600;
  font-size: 2.3vw;
  padding: 0.5em 0.3em;
  width: 5em;
  background-color: #154c79;
  color: #fff;
  outline: 0;
  border: 0;
  border-radius: 1.5em;
  cursor: pointer;
  display: inline-block;
  position: relative;
  box-shadow: rgba(255, 255, 255, .2) 0 3px 15px inset, rgba(0, 0, 0, .1) 0 3px 5px, rgba(0, 0, 0, .1) 0 10px 13px;
}
button:before {
  background-color: initial;
  background-image: linear-gradient(#fff 0, rgba(255, 255, 255, 0) 100%);
  opacity: .5;
  border-radius: 3.6em;
  height: 50%;
  left: 4%;
  position: absolute;
  top: 0;
  width: 92%;
  content: "";
}
button:hover {
  transform: scale(1.05);
}
.output {
  margin: 0 0 20px 0;
  font-size: 1.5vw;
  font-weight: 600;
  font-family: monospace;
}
.ok {
  color: #39d82b;
}
.fail {
  color: #d83d10;
}
div.viddiv {
  padding-top: 56.25%;
  width: 100%;
  position: relative;
}
img.vidya {
  width: 100%;
  height: 100%;
  position: absolute;
  inset: 0;
}
div.left {
  width: 28%;
  float: left;
}
div.right {
  width: 72%;
  float: left;
}
</style>

<script>
var handler = "handler.php?action=";

var v = 0;
var vidya_url = "http://192.168.0.18:8081/";

function vidyaUpdate() {
  document.getElementById("vidya_image").src = vidya_url + "?" + (v++);
}

function get(url, callback, fail) {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4) {
      if (this.status == 200) {
        callback(this);

        setTimeout(vidyaUpdate, 3000);
      }
      else {
        fail(this);
      }
    }
  };
  xhttp.open("GET", url, true);
  xhttp.send();
}

function go(thing) {
  var res = document.getElementById("res_".concat(thing));
  get(handler.concat(thing),
    function(xhtml) {
      res.innerHTML = (new Date).toLocaleString().concat(": <span class='ok'>", xhtml.responseText, "</span>");
    },
    function(xhtml) {
      res.innerHTML = ("<span class='fail'>").concat((new Date).toLocaleString(), ": ", xhtml.responseText, "</span>");
    }
  );
}
</script>
</head>

<body onLoad="vidyaUpdate()">

<div class="left">
  <div><button onclick="go('motion_start')">Start</button></div>
  <div class="out"><div class="output" id="res_motion_start">&nbsp;</div></div>
  <div><button onclick="go('motion_stop')">Stop</button></div>
  <div class="out"><div class="output" id="res_motion_stop">&nbsp;</div></div>
</div>

<div class="right">
  <div class="viddiv"><img id="vidya_image" class="vidya" onLoad="vidyaUpdate()" /></div>
</div>

</body>
</html>

